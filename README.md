###Mongo Tutorial - Command Sheet
$ mongo

#####Specify new database if not exists (it doesn't persist it straight away)
```
use <name_of_db>
```
```
use bank
```

#####List databases and collections
- Current databases: ```db```
- Persisted databases:```show dbs```
- Collections ```show collections```

#####Drop current database
```
db.dropDatabase()
```
#####Insert data (Example from [buckyrobert's repo](https://github.com/buckyroberts/Source-Code-from-Tutorials/blob/master/Other/SampleJsonData/fake_bank_data.json))

```
// create new collection users and insert data to it
db.users.insert{
  [
    {
      "isActive": false,
      "balance": "$3,960.64",
      "age": 30,
      "eyeColor": "blue",
      "name": "Dawn Keith",or:
      "gender": "female",
      "company": "COSMOSIS",
      "email": "dawnkeith@cosmosis.com",
      "phone": "+1 (839) 437-3421",
      "address": "392 Clifford Place, Fontanelle, Arizona, 2687"
    },
    {
      "isActive": false,
      "balance": "$1,280.14",
      "age": 31,
      "eyeColor": "green",
      "name": "Bettie Eaton",
      "gender": "female",
      "company": "COMTREK",
      "email": "bettieeaton@comtrek.com",
      "phone": "+1 (861) 460-2317",
      "address": "203 Allen Avenue, Elrama, North Carolina, 4453"
    }
  ]
}
```

#####Listing documents (registries)
```
db.users.find() // shows all documents
```
```
db.users.findOne()
```
```
db.users.find().limit(10) // shows only 10 documents
```
```
db.users.find().skip(3) // shows after the third document
```

#####Prettify output
```
db.users.find().pretty()
```

#####Selecting documents
```
db.users.find(
  {
    "name" : "Owen Hood"
  }
)
```
```
// comparison keywords: $lt, &gt, $lte, $gte and $ne
db.users.find(
  {
    "age": {$lt:23}
  }
)
```
```
// AND clause
db.users.find(
  {
      "age": {$lt:23},
      "company":"OVATION"
  }
)
```
```
// OR clause
db.users.find(
  {
    "gender" : "female",
    $or: [
      {"isActive":true},
      {"age": { $gte: 990 } }
    ]
  }
).pretty()
```
// IN clause
```
db.users.find(
  {
    age: { $in: [30, 35] } // brackets indicate interval 
  }
)
```
#####Formating output
```
db.users.find(
  { "age": { $lt: 40 } },
  {"name": 1, _id: 0}
)
```

#####Select by attribute
```
db.users.find(
  {
    "_id" : ObjectId("564a144ce1d05d069814a197") // autogenerated id
  }
)
```
```
// comparison keywords: $lt, &gt, $lte, $gte and $ne
db.users.find(
  {
    "age": {$lt:23}
  }
)
```
```
db.users.find(
  { "isActive": true },
  { "name": 1, "phone": 1, _id: 0 }
)
```

#####Update document
```
// will delete all attribs and keed updated name
db.users.update(
  {"_id" : ObjectId("564a144ce1d05d069814a197")},
  {"name":"John Locke"}
)
```

#####Inspect Query
```
db.users.find({ "age": {$lt:23} }).explain()
```
```
db.users.find({ "age": {$lt:23} }).explain("executionStats")
```

#####Indexes
```
db.users.ensureIndex({"age": 1})
```
```
db.users.getIndexes()
```
```
db.users.dropIndex({"age": 1})
```

#####Aggregations
```
db.users.aggregate(
  {
    $group: {
      _id: "$gender", avgAge: { $sum : "$age" }
    }
  }
)
```

#####Creating a database user
```
use bank
db.createUser(
    {
      user: "testing",
      pwd: "123456",
      roles: [
         { role: "readWrite", db: "users" },
         { role: "read", db: "products" },
         { role: "read", db: "sales" }
      ]
    }
)
```

##### Remover
```
db.testData.remove( { x: 2} ) // removes all documents from the inventory collection
```
```
db.testData.remove( { x: 18},1 ) // removes one document from the inventory collection
```

##### Functions
```
function insertData(dbName, colName, num) {
  var col = db.getSiblingDB(dbName).getCollection(colName);

  for (i = 0; i < num; i++) {
    col.insert({x:i});
  }
  print(col.count());
}
```
Usage:
```
insertData("ntbd", "testData", 400) // This operation inserts 400 documents into the testData collection in the ntbd database
```
